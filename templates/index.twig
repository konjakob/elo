{% block vars %}
{% endblock %}
<!DOCTYPE html>
<html lang="en">

<head>
    <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.2/css/uikit.min.css">
	<link href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet"/>
	<style>
      body {
        font-family: 'Raleway', sans-serif;
      }
    </style>

	<link href="css/jquery.cluetip.css" rel="stylesheet" type="text/css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="abcjs_editor_1.7-min.js" type="text/javascript"></script>
	<script src="js/jquery.cluetip.js"></script>
	<script src="js/general.js"></script>	
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-form-validator/2.3.26/jquery.form-validator.min.js"></script>
	
	{% block headerInjection %}{% endblock %}
	
</head>

<body>
	<noscript><div class="no-script"><div class="no-script-inner">{{ constant('MODULE_HEADER_TAGS_NOSCRIPT_TEXT') }}</div></div></noscript>
    <div class="uk-offcanvas-content">


      {% block index %}{% endblock %}


	</div>

	<!-- JS FILES -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.2/js/uikit.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.2/js/uikit-icons.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" rel="stylesheet" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>
	<script>
		toastr.options = {
		  "closeButton": false,
		  "debug": false,
		  "newestOnTop": false,
		  "progressBar": false,
		  "positionClass": "toast-top-right",
		  "preventDuplicates": false,
		  "onclick": null,
		  "showDuration": "300",
		  "hideDuration": "1000",
		  "timeOut": "5000",
		  "extendedTimeOut": "1000",
		  "showEasing": "swing",
		  "hideEasing": "linear",
		  "showMethod": "fadeIn",
		  "hideMethod": "fadeOut"
		}
		
		{% if 'CREATE_ATTACHMENTS' in user_rights|keys or uploadPath == 'profile' %}
		var bar = document.getElementById('js-progressbar');
		var divImages = document.getElementById('divImages');

		UIkit.upload('.js-upload', {
			
			url: 'upload-images.php?mode={% if uploadPath == 'profile' %}profile{% else %}review{% endif %}',{# We need to check, if it is an attachment for topics or replies or a profile picture #}
			multiple: true,

			complete: function () {
				var data = JSON.parse(arguments[0]['responseText']);
				{% if uploadPath == 'profile' %}
				if ( data.state == 'ok' ) {
					var maxLength = (data.width < data.height) ? data.width : data.height;
					var wile =  '';
					if ( maxLength > 400 ) {
						if ( data.height > 400 ) {
							wile = 'width="' + data.width/data.height*400 + '" height="400"';
						} else {
							wile = 'width="400" height="' + data.height/data.width*400 + '"';
						}
					} else {
						wile = 'width="' + data.width + '" height="' + data.height + '"';
					}
					
					$('#userImage').html('<img src="' + data.filePath  + '?timestamp=' + Date.now() + '" id="profile-image" width="100" height="100">');
                    $('#userImageCrop').html('<img src="' + data.filePath + '" id="profile-image-crop" ' + wile + '>');
					
                    
                    $('#profile-image-crop').imgAreaSelect({ aspectRatio: '1:1', handles: true, x1: 0.1*maxLength, y1: 0.1*maxLength, x2: 0.9*maxLength, y2: 0.9*maxLength, onSelectEnd: function (img, selection) { $('input[name="crop-x1"]').val(selection.x1); $('input[name="crop-y1"]').val(selection.y1); $('input[name="crop-x2"]').val(selection.x2); $('input[name="crop-y2"]').val(selection.y2); }                    
                    });
                    UIkit.modal($('#modal-image-crop')).show();
                    
				}
				{% else %}
				if (data.preview) {
					divImages.innerHTML += '<div><img src="' + data.preview + '" width="100"><input type="hidden" name="picture[]" value="' + data.fileId + '"></div>';
				} else {
					divImages.innerHTML += '<div><input type="hidden" name="picture[]" value="' + data.fileId + '">' + data.fileName + '</div>';
				}
				
				{% endif %}
			},

			loadStart: function (e) {
				bar.removeAttribute('hidden');
				bar.max = e.total;
				bar.value = e.loaded;
			},

			progress: function (e) {
				bar.max = e.total;
				bar.value = e.loaded;
			},

			loadEnd: function (e) {
				bar.max = e.total;
				bar.value = e.loaded;
			},

			completeAll: function () {
				setTimeout(function () {
					bar.setAttribute('hidden', 'hidden');
				}, 1000);
			}

		});
		{% endif %}
		

		$.validate({
			lang: '{{ langcode }}'
		});
		
		$(document).ready(function() {
			$('.js-select2').select2();		
		});
		
		function tgldiv(divname){
			$("#"+divname).slideToggle("slow");
		}

	
		</script>
	{% block footerInjection %}{% endblock %}
</body>

</html>